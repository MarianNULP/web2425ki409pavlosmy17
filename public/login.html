<!DOCTYPE html><html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/style.css" rel="stylesheet">
</head>
<body>

<main class="form-auth">
  <h2 class="mb-3 text-center">Вхід</h2>

  <form id="logForm" novalidate>
    <div class="form-floating mb-2">
      <input type="email" class="form-control" id="email" name="email" placeholder="name@example.com" required>
      <label for="email">Email</label>
    </div>
    <div class="form-floating mb-3">
      <input type="password" class="form-control" id="pwd" name="password" placeholder="Password" required>
      <label for="pwd">Пароль</label>
    </div>
    <button class="w-100 btn btn-lg btn-primary">Увійти</button>
  </form>

  <p class="mt-3 text-center"><a href="/register.html">Немає акаунта? Реєстрація</a></p>
  <div id="msg" class="mt-3 text-center"></div>
</main>

<script>
logForm.onsubmit = async e => {
  e.preventDefault();
  const fd = new FormData(logForm);
  const r = await fetch('/login', {
    method:'POST',
    body: new URLSearchParams(fd),
    headers:{'Content-Type':'application/x-www-form-urlencoded'}
  });
  const out = document.getElementById('msg');
  const data = await r.json();
  if (r.ok) {
    localStorage.setItem('token', data.token);
    out.innerHTML = '<span class="text-success">✅ Вхід успішний!...</span>';
    setTimeout(()=>location='/dashboard.html', 1000);
  } else {
    out.innerHTML = '<span class="text-danger">❌ '+data.error+'</span>';
  }
};
</script>
</body></html>
