<!DOCTYPE html><html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Register</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/style.css" rel="stylesheet">
</head>
<body>

<main class="form-auth">
  <h2 class="mb-3 text-center">Реєстрація</h2>

  <form id="regForm" class="needs-validation" novalidate>
    <div class="form-floating mb-2">
      <input type="email" class="form-control" id="email" name="email" placeholder="name@example.com" required>
      <label for="email">Email</label>
    </div>
    <div class="form-floating mb-3">
      <input type="password" class="form-control" id="pwd" name="password" placeholder="Password" required>
      <label for="pwd">Пароль</label>
    </div>
    <button class="w-100 btn btn-lg btn-warning">Зареєструватись</button>
  </form>

  <p class="mt-3 text-center"><a href="/login.html">Маэте акаунт? Увійти</a></p>
  <a href="/auth/google"><img src="/btn_google_signin.png" /></a>
  <div id="msg" class="mt-3 text-center"></div>
</main>

<script>
regForm.onsubmit = async e => {
  e.preventDefault();
  if (!regForm.checkValidity()) return regForm.classList.add('was-validated');

  const fd = new FormData(regForm);
  const r = await fetch('/register', {
    method:'POST',
    body: new URLSearchParams(fd),
    headers:{'Content-Type':'application/x-www-form-urlencoded'}
  });
  const out = document.getElementById('msg');
  if (r.ok) {
    out.innerHTML = '<span class="text-success">✅ Успішно! Перенаправлення…</span>';
    setTimeout(()=>location='/login.html', 1200);
  } else {
    out.innerHTML = '<span class="text-danger">❌ '+(await r.json()).error+'</span>';
  }
};
</script>
</body></html>
