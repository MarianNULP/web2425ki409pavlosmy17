<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>AJAX-форми</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    section { margin-bottom: 2rem; }
    ul { list-style: none; padding-left: 0; }
    li { background: #eef; margin: 0.5rem 0; padding: 0.5rem; border-radius: 4px; }
    .loaded { font-size: 0.9rem; color: #666; margin-bottom: 1rem; }
  </style>
</head>
<body>

  <!-- Ось додали рядок із часом завантаження -->
  <p class="loaded">
    Сторінка завантажена: <span id="loaded"></span>
  </p>

  <section>
    <h2>GET (AJAX)</h2>
    <input id="getInput" placeholder="Введіть текст…">
    <button id="getBtn">GET + час</button>
    <ul id="getList"></ul>
  </section>

  <section>
    <h2>POST (AJAX)</h2>
    <input id="postInput" placeholder="Введіть текст…">
    <button id="postBtn">POST + ехо</button>
    <ul id="postList"></ul>
  </section>

  <script>
  const getInput  = document.getElementById('getInput');
  const getBtn    = document.getElementById('getBtn');
  const getList   = document.getElementById('getList');

  const postInput = document.getElementById('postInput');
  const postBtn   = document.getElementById('postBtn');
  const postList  = document.getElementById('postList');

  // час завантаження
  document.getElementById('loaded').textContent =
    new Date().toLocaleString();

  // GET (AJAX) — очищаємо список перед додаванням
  getBtn.onclick = async () => {
    const v   = getInput.value;
    const res = await fetch('/api/time?data=' + encodeURIComponent(v));
    const j   = await res.json();

    // ОЧИЩАЄМО попередній результат
    getList.innerHTML = '';

    // Додаємо новий
    const li = document.createElement('li');
    li.textContent = `[GET] "${j.youSent.data}" → ${new Date(j.ts).toLocaleString()}`;
    getList.append(li);
  };

  // POST (AJAX) — аналогічно очищаємо
  postBtn.onclick = async () => {
    const v   = postInput.value;
    const res = await fetch('/api/echo', {
      method:  'POST',
      headers: {'Content-Type':'application/json'},
      body:    JSON.stringify({data: v})
    });
    const j   = await res.json();

    // ОЧИЩАЄМО попередній результат
    postList.innerHTML = '';

    // Додаємо новий
    const li = document.createElement('li');
    li.textContent = `[POST] "${j.youSent.data}" → ${new Date(j.ts).toLocaleString()}`;
    postList.append(li);
  };
  </script>
</body>
</html>
